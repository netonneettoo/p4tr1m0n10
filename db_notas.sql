-- START TRANSACTION
START TRANSACTION;

-- SHOW CREATE DATABASE DB_NOTAS
CREATE DATABASE `DB_NOTAS`;

-- USE DB_NOTA
USE DB_NOTA;

-- SHOW CREATE TABLE STATUS_NOTA
CREATE TABLE `STATUS_NOTA` (
    ID INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
    STATUS_NOTA VARCHAR(45) NOT NULL,
    UNIQUE(STATUS_NOTA)
);

-- INSERT INTO STATUS_NOTA
INSERT INTO STATUS_NOTA (ID, STATUS_NOTA) VALUES (1, `EM ABERTO`);
INSERT INTO STATUS_NOTA (ID, STATUS_NOTA) VALUES (2, `PAGO`);

-- SHOW CREATE TABLE FORNECEDOR
CREATE TABLE `FORNECEDOR` (
    ID INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
    RAZAO_SOCIAL VARCHAR(45) NOT NULL,
    EMAIL VARCHAR(255) DEFAULT NULL,
    TELEFONE_CASA VARCHAR(10) DEFAULT NULL, -- EX: 1122223333
    TELEFONE_CELULAR VARCHAR(10) DEFAULT NULL, -- EX: 1122223333
    TELEFONE_COMERCIAL VARCHAR(10) DEFAULT NULL, -- EX: 1122223333
    OBSERVACAO VARCHAR(255) DEFAULT NULL,
    UNIQUE(RAZAO_SOCIAL),
    UNIQUE(EMAIL)
);

-- SHOW CREATE TABLE NOTA
CREATE TABLE `NOTA` (
    ID INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
    FORNECEDOR INT UNSIGNED NOT NULL, -- FK
    DATA_CADASTRO DATE DEFAULT NULL,
    VALOR DEC(11,2) DEFAULT 0.00,
    PARCELAS INT UNSIGNED DEFAULT 1,
    STATUS_NOTA INT UNSIGNED DEFAULT 1, -- FK
    OBSERVACAO VARCHAR(255) DEFAULT NULL,
    CONSTRAINT `FK_FORNECEDOR_NOTA` FOREIGN KEY(FORNECEDOR) REFERENCES FORNECEDOR (ID),
    CONSTRAINT `FK_STATUS_NOTA_NOTA` FOREIGN KEY(STATUS_NOTA) REFERENCES STATUS_NOTA (ID)
);

-- SHOW CREATE TABLE PARCELA
CREATE TABLE `PARCELA` (
    ID_NOTA INT UNSIGNED NOT NULL, -- FK
    NUMERO_PARCELA INT UNSIGNED NOT NULL,
    DATA_VENCIMENTO DATE DEFAULT NULL,
    VALOR DEC(11,2) NOT NULL,
    STATUS_PARCELA INT UNSIGNED NOT NULL,
    OBSERVACAO VARCHAR(255) DEFAULT NULL,
    CONSTRAINT `PK_ID_NOTA_PARCELA` PRIMARY KEY(ID_NOTA, NUMERO_PARCELA),
    CONSTRAINT `FK_STATUS_PARCELA_PARCELA` FOREIGN KEY (STATUS_PARCELA) REFERENCES STATUS_PARCELA (ID)
);

-- COMMIT
COMMIT;
